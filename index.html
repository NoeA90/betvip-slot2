<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>BET300 ¬∑ Promo interactiva</title>
<style>
  :root{
    --bg:#070b22; --panel:#0f1536; --ink:#eef3ff;
    --brand1:#ffb03a; --brand2:#ff2f6d;
    --cta1:#ff2f55; --cta2:#ff8d3a; --cta3:#00c98b; --cta4:#37e06b;
    --accent:#00f0ff;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial}
  header{display:flex;justify-content:space-between;align-items:center;padding:14px 16px}
  .logo{background:linear-gradient(45deg,var(--brand1),var(--brand2));padding:6px 16px;border-radius:12px;font-weight:900;color:#161616}
  .pill{display:inline-flex;gap:8px;align-items:center;background:linear-gradient(90deg,#1a2247,#27366a);padding:10px 14px;border-radius:14px;font-size:15px}
  .row{display:flex;gap:10px;align-items:center;padding:0 16px 8px;flex-wrap:wrap}

  /* Enlace plataforma */
  .link-pill{cursor:pointer; user-select:none}

  /* Escena */
  .stage{margin:0 auto;background:#0b1231;border-radius:18px;padding:14px;max-width:920px}
  .wheel-box{display:grid;place-items:center}
  .wheel-wrap{position:relative;width:clamp(280px,92vw,540px);aspect-ratio:1/1}
  canvas{width:100%;height:100%;display:block}
  .pointer{position:absolute;left:50%;top:-8px;transform:translateX(-50%);width:0;height:0;border-left:18px solid transparent;border-right:18px solid transparent;border-bottom:30px solid var(--accent);filter:drop-shadow(0 0 10px rgba(0,255,255,.55));z-index:2}

  /* Panel resultado */
  .panel{max-width:920px;margin:10px auto 16px;background:var(--panel);border-radius:16px;padding:14px}
  .result{display:flex;align-items:center;gap:12px}
  .badge{display:grid;place-items:center;width:90px;height:58px;border-radius:16px;background:linear-gradient(135deg,#253064,#3a1f78);font-weight:900;font-size:22px}
  .title{margin:0 0 6px;font-size:22px;font-weight:900}

  /* CTA inferior */
  .cta{position:sticky;bottom:0;padding:10px 12px;background:linear-gradient(180deg,rgba(7,11,34,0),rgba(7,11,34,.9));backdrop-filter:blur(6px);display:flex;gap:10px}
  .btn{flex:1;min-height:56px;border:none;border-radius:14px;font-weight:900;color:#fff;font-size:18px;cursor:pointer}
  .btn:active{transform:translateY(1px)}
  .btn-spin{background:linear-gradient(45deg,var(--cta1),var(--cta2))}
  .btn-claim{background:linear-gradient(45deg,var(--cta3),var(--cta4))}

  /* WhatsApp flotante */
  .wa{position:fixed;right:16px;bottom:16px;width:66px;height:66px;border-radius:50%;display:grid;place-items:center;background:#25d366;box-shadow:0 10px 24px rgba(0,0,0,.35);animation:pulse 1.6s infinite;z-index:5}
  .wa svg{width:34px;height:34px;fill:#fff}
  @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.08)}}

  .mute{cursor:pointer}
</style>
</head>
<body>
<header>
  <div class="logo">BET300</div>
  <div class="pill">Promo interactiva ¬∑ v√°lida <b> hoy</b></div>
</header>

<div class="row">
  <div class="pill">‚è≥ <span id="timer">--:--:--</span></div>
  <div class="pill mute" id="soundToggle">üîä Sonido: <b id="soundState">ON</b></div>
  <div class="pill link-pill" id="platformLink">‚Üó Acceder a la plataforma</div>
</div>

<section class="stage">
  <div class="wheel-box">
    <div class="wheel-wrap" id="wheelWrap">
      <div class="pointer"></div>
      <canvas id="wheel"></canvas>
    </div>
  </div>
</section>

<section class="panel">
  <div class="result">
    <div class="badge" id="badge">-</div>
    <div>
      <h3 class="title" id="resultTitle">Ten√©s 1 giro disponible</h3>
      <div id="resultText">Los premios se acreditan con tu <b>pr√≥xima carga m√≠nima</b>.</div>
    </div>
  </div>
</section>

<div class="cta">
  <button class="btn btn-spin" id="spinBtn">üé∞ Girar</button>
  <button class="btn btn-claim" id="claimBtn">üì≤ Reclamar</button>
</div>

<a class="wa" id="waFloat" aria-label="WhatsApp">
  <svg viewBox="0 0 32 32"><path d="M19.11 17.56c-.27-.14-1.61-.8-1.86-.89-.25-.09-.43-.14-.61.14s-.7.89-.86 1.08c-.16.2-.32.2-.59.07-.27-.14-1.14-.42-2.17-1.35-.8-.71-1.35-1.6-1.51-1.87-.16-.27-.02-.42.12-.56.12-.12.27-.32.41-.48.14-.16.18-.27.27-.45.09-.18.05-.34-.02-.48-.07-.14-.61-1.47-.83-2.02-.22-.53-.45-.46-.61-.46h-.52c-.18 0-.48.07-.73.34s-.96.94-.96 2.29 1 2.65 1.14 2.83c.14.18 1.96 2.98 4.75 4.18.66.29 1.18.46 1.58.59.66.21 1.27.18 1.75.11.53-.08 1.61-.66 1.84-1.29.23-.63.23-1.17.16-1.29-.07-.12-.25-.2-.52-.34zM16.02 3.2C9.84 3.2 4.82 8.21 4.82 14.4c0 2.35.76 4.53 2.04 6.31L5.2 28.8l8.28-1.62c1.73.95 3.71 1.49 5.82 1.49 6.18 0 11.2-5.01 11.2-11.2S22.2 3.2 16.02 3.2z"/></svg>
</a>

<script>
/* ======== CONFIG Y ESTADO ======== */
const TEXT_MODE = 'radial'; // 'radial' (de adentro hacia afuera) | 'tangent' (horizontal)
const prizes = [
  "$2.000","$3.000","10%","$4.000","20%","$5.000",
  "30%","$6.000","40%","$7.000","$8.000","$9.000","$10.000","50%"
];
const seg = 2*Math.PI/prizes.length;
const colors = ["#bfe7ff","#ffc7f2","#b8ffdf","#ffe5a3"]; // alternados
const bulbs = 54;

let soundOn = true;
const spinSfx = new Audio('https://cdn.jsdelivr.net/gh/jackyzha0/sfx/spin.mp3');
const winSfx  = new Audio('https://www.soundjay.com/human/sounds/applause-8.mp3');

const canvas = document.getElementById('wheel');
const ctx = canvas.getContext('2d');
let size, radius, center, animId;
let angle = 0;              // √°ngulo actual
let velocity = 0;           // velocidad angular
let spinning = false;

/* ======== RESPONSIVE & DIBUJO ======== */
function resize(){
  const wrap = document.getElementById('wheelWrap');
  const px = Math.floor(wrap.clientWidth * window.devicePixelRatio);
  canvas.width = px;
  canvas.height = px;
  size = px;
  radius = px/2;
  center = {x:radius, y:radius};
  draw();
}
window.addEventListener('resize', ()=>{ cancelAnimationFrame(animId); draw(); resize(); });
resize();

function draw(){
  ctx.clearRect(0,0,size,size);

  ctx.save();
  ctx.translate(center.x, center.y);
  ctx.rotate(angle);

  // slices
  for(let i=0;i<prizes.length;i++){
    const a0 = i*seg - Math.PI/2;
    const a1 = a0 + seg;

    // sector
    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.arc(0,0, radius*0.86, a0, a1);
    ctx.closePath();
    ctx.fillStyle = colors[i%colors.length];
    ctx.fill();

    // texto
    const mid = (a0+a1)/2;
    ctx.save();
    ctx.rotate(mid);

    // posici√≥n del texto
    const rText = radius*0.7;

    if (TEXT_MODE === 'radial'){
      // De adentro hacia afuera (vertical radial)
      ctx.translate(rText, 0);
      ctx.rotate(-Math.PI/2); // apunto ‚Äúhacia afuera‚Äù
    } else {
      // Horizontal tangencial
      ctx.translate(rText, 0);
      // evitar patas arriba
      const m = (mid % (Math.PI*2) + Math.PI*2)%(Math.PI*2);
      if (m > Math.PI/2 && m < 3*Math.PI/2) ctx.rotate(Math.PI);
    }

    ctx.fillStyle = "#0a0f2c";
    ctx.lineWidth = 6;
    ctx.font = `${Math.floor(size*0.06)}px 800 system-ui,Arial`;
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    ctx.strokeStyle="#fff";
    ctx.strokeText(prizes[i],0,0);
    ctx.fillText(prizes[i],0,0);

    ctx.restore();
  }

  // aro exterior
  ctx.beginPath();
  ctx.lineWidth = Math.max(8, size*0.02);
  ctx.strokeStyle = "#4b516a";
  ctx.arc(0,0, radius*0.92, 0, Math.PI*2);
  ctx.stroke();

  // luces
  const bulbsR = radius*0.92;
  const t = Date.now()/120;
  for(let i=0;i<bulbs;i++){
    const a = (i/bulbs)*Math.PI*2;
    const x = Math.cos(a)*bulbsR;
    const y = Math.sin(a)*bulbsR;
    const on = Math.floor(t)%bulbs === i;
    ctx.beginPath();
    ctx.fillStyle = on ? "rgba(215,230,255,1)" : "rgba(215,230,255,.5)";
    ctx.arc(x,y, Math.max(3, size*0.008), 0, Math.PI*2);
    ctx.fill();
  }

  // centro
  ctx.beginPath();
  ctx.fillStyle="#0a0f2c";
  ctx.arc(0,0, radius*0.15, 0, Math.PI*2);
  ctx.fill();
  ctx.lineWidth = Math.max(4,size*0.01);
  ctx.strokeStyle="#7da6ff";
  ctx.stroke();

  ctx.restore();
}

function frame(){
  if(velocity>0.0002){
    angle += velocity;
    velocity *= 0.985;
    draw();
    animId = requestAnimationFrame(frame);
  }else{
    velocity = 0;
    spinning=false;
    draw();
    let a = (angle % (Math.PI*2) + Math.PI*2) % (Math.PI*2);
    const idx = Math.floor(((Math.PI*1.5 - a + Math.PI*2) % (Math.PI*2)) / seg) % prizes.length;
    const prize = prizes[idx];
    document.getElementById('badge').textContent = prize;
    document.getElementById('resultTitle').textContent = 'üéâ ¬°Premio obtenido!';
    document.getElementById('resultText').innerHTML = `Recib√≠s <b>${prize}</b> en tu pr√≥xima carga.`;
    if(soundOn){ try{winSfx.currentTime=0; winSfx.play();}catch(e){} }
  }
}

/* ======== INTERACCI√ìN ======== */
function spin(){
  if(spinning) return;
  spinning = true;
  velocity = 0.45 + Math.random()*0.35;
  if(soundOn){ try{spinSfx.currentTime=0; spinSfx.play();}catch(e){} }
  animId = requestAnimationFrame(frame);
}
document.getElementById('spinBtn').addEventListener('click', spin);
document.getElementById('wheelWrap').addEventListener('click', (e)=>{
  const rect = e.currentTarget.getBoundingClientRect();
  const cx = rect.left + rect.width/2;
  const cy = rect.top + rect.height/2;
  const dx = e.clientX - cx, dy = e.clientY - cy;
  if(Math.hypot(dx,dy) < rect.width*0.5) spin();
});

/* ======== SONIDO / TIMER ======== */
document.getElementById('soundToggle').addEventListener('click', ()=>{
  soundOn = !soundOn;
  document.getElementById('soundState').textContent = soundOn?'ON':'OFF';
});
let left=3*3600; // 3 horas
setInterval(()=>{
  if(left<=0) return; left--;
  const h=String(Math.floor(left/3600)).padStart(2,'0');
  const m=String(Math.floor((left%3600)/60)).padStart(2,'0');
  const s=String(left%60).padStart(2,'0');
  document.getElementById('timer').textContent = `${h}:${m}:${s}`;
},1000);

/* ======== WHATSAPP + ?pc y Plataforma ======== */
const params=new URLSearchParams(location.search);
const pc=params.get('pc');
const whatsappByPc={1:'5491111111111',2:'5492222222222',3:'5493333333333'};
const platformByPc={1:'https://tu-plataforma-1.com',2:'https://tu-plataforma-2.com',3:'https://tu-plataforma-3.com'};
const wa=whatsappByPc[pc]||whatsappByPc[1];
const platformUrl=platformByPc[pc]||platformByPc[1];

function claim(){
  const msg=encodeURIComponent('¬°Quiero reclamar mi premio de la promo!');
  window.open(`https://wa.me/${wa}?text=${msg}`,'_blank');
}
document.getElementById('claimBtn').addEventListener('click', claim);
document.getElementById('waFloat').addEventListener('click', claim);
document.getElementById('platformLink').addEventListener('click', ()=>{ window.open(platformUrl,'_blank'); });
</script>
</body>
</html>
