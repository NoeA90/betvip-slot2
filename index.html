<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>BET300 ¬∑ Promo interactiva</title>
<style>
  :root{
    --bg:#070c1a;
    --card:#0f1730;
    --chip:#1a2447;
    --text:#eaf1ff;
    --accent:#4dd3a6;
    --accent2:#ff5964;
    --ring:#d8e7ff;
  }
  *{box-sizing:border-box}
  body{margin:0;background:radial-gradient(1200px 500px at 50% -100px,#0b1635 0,#070c1a 50%,#020614 100%);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial}
  .container{max-width:680px;margin:auto;padding:14px}
  .toprow{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .badge{background:linear-gradient(135deg,#ffc77e,#ff8aa8);color:#1c1020;padding:8px 14px;border-radius:16px;font-weight:800;letter-spacing:.5px}
  .pill{background:linear-gradient(135deg,#222e57,#1c264a);padding:8px 14px;border-radius:16px;display:flex;gap:8px;align-items:center;font-weight:600;opacity:.95}
  .cta-platform{margin-left:auto;background:linear-gradient(135deg,#2c7be5,#00d4ff);color:#071225;border:none;border-radius:14px;padding:8px 14px;font-weight:800;cursor:pointer;text-decoration:none;box-shadow:0 6px 20px rgba(0,212,255,.25)}
  .panel{margin-top:14px;background:var(--card);border-radius:22px;padding:18px;box-shadow:0 10px 40px rgba(0,0,0,.25)}
  .stage{position:relative;display:flex;justify-content:center;align-items:center;aspect-ratio:1/1}
  canvas{width:100%;height:auto;max-width:560px;display:block}
  /* bot√≥n reclamo inferior */
  .controls{position:sticky;bottom:0;left:0;right:0;background:linear-gradient(180deg,transparent,rgba(7,12,26,.75) 35%,rgba(7,12,26,.95));backdrop-filter:blur(8px);padding:14px 10px;margin:0 -10px}
  .btns{display:flex;gap:12px}
  .btn{flex:1;border:none;border-radius:14px;padding:14px 16px;font-size:18px;font-weight:800;cursor:pointer}
  .btn-spin{background:linear-gradient(135deg,#ff8aa8,#ff5964);color:white;box-shadow:0 10px 20px rgba(255,89,100,.25)}
  .btn-claim{background:#25d366;color:#03210f;display:flex;align-items:center;justify-content:center;gap:10px;box-shadow:0 10px 20px rgba(37,211,102,.28)}
  .btn-claim.pulse{animation:pulse 1.6s infinite}
  @keyframes pulse{
    0%{transform:scale(1);box-shadow:0 0 0 0 rgba(37,211,102,.55)}
    60%{transform:scale(1.06);box-shadow:0 0 0 20px rgba(37,211,102,0)}
    100%{transform:scale(1);box-shadow:0 0 0 0 rgba(37,211,102,0)}
  }
  .result{display:flex;align-items:center;gap:14px}
  .prizechip{min-width:86px;text-align:center;padding:14px;border-radius:16px;background:linear-gradient(135deg,#273a78,#2d1e74)}
  .result h2{margin:0;font-size:28px}
  .muted{opacity:.85}
  /* que la ruleta nunca se corte */
  .stage{padding:14px}
  @media (min-width:760px){
    .stage{padding:22px}
  }
</style>
</head>
<body>
  <div class="container">
    <div class="toprow">
      <div class="badge">BET300</div>
      <div class="pill">Promo interactiva ¬∑ v√°lida <b>&nbsp;hoy</b></div>
      <div class="pill">‚è≥ <span id="timer">--:--</span></div>
      <a id="platformLink" class="cta-platform" href="#" target="_blank" rel="noopener">Acceder a la plataforma</a>
    </div>

    <div class="panel">
      <div class="stage">
        <canvas id="wheel" width="560" height="560"></canvas>
      </div>
    </div>

    <div class="panel">
      <div class="result">
        <div class="prizechip" id="prizeChip">-</div>
        <div>
          <h2 id="resultTitle">Ten√©s 1 giro disponible</h2>
          <div class="muted" id="resultSub">Los premios se acreditan con tu <b>pr√≥xima carga m√≠nima</b>.</div>
        </div>
      </div>
    </div>
  </div>

  <div class="controls">
    <div class="btns">
      <button class="btn btn-spin" id="spinBtn">üé∞ Girar</button>
      <a class="btn btn-claim pulse" id="claimBtn" href="#" target="_blank" rel="noopener" aria-label="Reclamar por WhatsApp">
        <svg width="22" height="22" viewBox="0 0 32 32" fill="none" aria-hidden="true">
          <path fill="#075E54" d="M16 3C9.37 3 4 8.37 4 15c0 2.42.7 4.67 1.9 6.56L4 29l7.67-1.86C13.5 28.3 14.7 29 16 29c6.63 0 12-5.37 12-12S22.63 3 16 3z"/>
          <path fill="#25D366" d="M11.59 8.66c-.28-.62-.58-.63-.85-.64-.22-.01-.47-.01-.72-.01s-.66.09-1 .5c-.34.4-1.31 1.28-1.31 3.11s1.34 3.61 1.53 3.86c.19.25 2.59 4.15 6.4 5.65 3.17 1.25 3.81 1 4.5.94.69-.06 2.22-.9 2.54-1.78.31-.88.31-1.64.22-1.79-.09-.16-.34-.25-.72-.44-.38-.19-2.22-1.09-2.56-1.22-.34-.13-.59-.19-.84.19-.25.38-.97 1.22-1.19 1.47-.22.25-.44.28-.81.09-.38-.19-1.6-.59-3.05-1.88-1.13-.99-1.89-2.21-2.12-2.59-.22-.38-.02-.58.17-.77.17-.17.38-.44.56-.66.19-.22.25-.38.38-.63.13-.25.06-.47-.03-.66-.09-.19-.84-2.15-1.19-2.97z"/>
        </svg>
        Reclamar
      </a>
    </div>
  </div>

  <!-- Sonidos -->
  <audio id="sndSpin" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3" preload="auto"></audio>
  <audio id="sndWin"  src="https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3" preload="auto"></audio>

<script>
/* =========================
   1) Par√°metros & mapeos
========================= */
const params = new URLSearchParams(location.search);
const pcParam = (params.get('pc') || '').toLowerCase(); // ej: pc1, pc2‚Ä¶
const forcePlatform = params.get('pl');                  // opcional: URL plataforma directa

// EDIT√Å ESTE MAPA CON TUS DATOS
const PC_MAP = {
  pc1: { wa: '5491111111111', platform: 'https://tu-plataforma-1.com' },
  pc2: { wa: '5492222222222', platform: 'https://tu-plataforma-2.com' },
  pc3: { wa: '5493333333333', platform: 'https://tu-plataforma-3.com' }
};
// fallback (si no hay pc)
const DEFAULT_WA = '5491100000000';
const DEFAULT_PLATFORM = 'https://tusitio.com';

/* =========================
   2) Enlaces din√°micos
========================= */
const platformLink = document.getElementById('platformLink');
const claimBtn = document.getElementById('claimBtn');

const mapItem = PC_MAP[pcParam] || {};
const waNumber = mapItem.wa || DEFAULT_WA;
const platformUrl = forcePlatform || mapItem.platform || DEFAULT_PLATFORM;

// set plataforma
platformLink.href = platformUrl;

// n√∫mero WA se completa al ganar, para incluir premio en el texto
let lastPrizeText = "";

/* =========================
   3) Temporizador simple
========================= */
(function startTimer(dur=3600){
  let t=dur; const el=document.getElementById('timer');
  setInterval(()=>{const m=String(Math.floor(t/60)).padStart(2,'0');const s=String(t%60).padStart(2,'0');el.textContent=`${m}:${s}`;t=t? t-1:dur;},1000);
})();

/* =========================
   4) Ruleta (canvas)
========================= */
const canvas = document.getElementById('wheel');
const ctx = canvas.getContext('2d');

const slices = [
  "$2.000","$3.000","20%","$4.000","30%","$5.000","40%",
  "$6.000","50%","$7.000","$8.000","$9.000","$10.000","10%"
];
const colors = ["#9bd5ff","#fde74c","#9bc53d","#ffb0cb","#ffc77e","#9bd5ff","#fde74c","#9bc53d","#ffb0cb","#ffc77e","#9bd5ff","#fde74c","#9bc53d","#ffb0cb"];
let arc = Math.PI*2/slices.length;
let angle = 0;
let spinning = false;

function resizeCanvas(){
  const max = Math.min(560, Math.min(window.innerWidth-28, 560));
  canvas.width = max;
  canvas.height = max;
  draw();
}
window.addEventListener('resize', resizeCanvas);

function draw(){
  const R = canvas.width/2 - 34;   // margen generoso para luces
  const rText = R - 42;
  const rHole = 24;

  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.save();
  ctx.translate(canvas.width/2, canvas.height/2);
  ctx.rotate(angle);

  ctx.font = "bold 18px system-ui, Arial";
  ctx.textBaseline="middle";
  ctx.textAlign="center";

  // slices
  for(let i=0;i<slices.length;i++){
    const a0 = i*arc, a1=a0+arc;
    ctx.beginPath();
    ctx.fillStyle = colors[i];
    ctx.moveTo(0,0);
    ctx.arc(0,0,R,a0,a1);
    ctx.closePath(); ctx.fill();

    ctx.save();
    ctx.rotate(a0+arc/2);
    ctx.fillStyle="#0b0f1a";
    ctx.fillText(slices[i], 0, -rText);
    ctx.restore();
  }

  // borde y centro
  ctx.beginPath(); ctx.lineWidth=14; ctx.strokeStyle="#cfe3ff";
  ctx.arc(0,0,R+18,0,Math.PI*2); ctx.stroke();

  // luces
  for(let i=0;i<36;i++){
    const a = i*(Math.PI*2/36);
    const x = Math.cos(a)*(R+10);
    const y = Math.sin(a)*(R+10);
    ctx.beginPath();
    ctx.fillStyle = i%2? "#ffffff" : "#ffee88";
    ctx.arc(x,y,6,0,Math.PI*2); ctx.fill();
  }

  // agujero central
  ctx.beginPath(); ctx.fillStyle="#0b0f1a";
  ctx.arc(0,0,rHole,0,Math.PI*2); ctx.fill();

  ctx.restore();

  // flecha
  ctx.beginPath();
  ctx.fillStyle="#4dd3ff";
  const topY = 30;
  ctx.moveTo(canvas.width/2-18, topY);
  ctx.lineTo(canvas.width/2+18, topY);
  ctx.lineTo(canvas.width/2, topY+26);
  ctx.closePath(); ctx.fill();
}

const sndSpin = document.getElementById('sndSpin');
const sndWin  = document.getElementById('sndWin');

function spin(){
  if(spinning) return;
  spinning=true;
  sndSpin.currentTime=0; sndSpin.play();

  const spinMs = 4200 + Math.random()*1800;
  const start = performance.now();
  const startAngle = angle;
  const endAngle = angle + (Math.PI*6) + Math.random()*Math.PI*2;

  function tick(now){
    const p = Math.min(1, (now-start)/spinMs);
    // easeOutCubic
    const e = 1 - Math.pow(1-p, 3);
    angle = startAngle + (endAngle-startAngle)*e;
    draw();
    if(p<1) requestAnimationFrame(tick);
    else finish();
  }
  requestAnimationFrame(tick);

  function finish(){
    sndWin.currentTime=0; sndWin.play();
    spinning=false;

    // calcular √≠ndice bajo la flecha
    const degrees = (angle % (Math.PI*2)) * 180/Math.PI;
    const normalized = (360 - (degrees+90)%360); // flecha arriba
    const idx = Math.floor(normalized / (360/slices.length)) % slices.length;
    lastPrizeText = slices[idx];

    // UI
    document.getElementById('prizeChip').textContent = lastPrizeText;
    document.getElementById('resultTitle').textContent = "¬°Premio obtenido!";
    document.getElementById('resultSub').innerHTML = `Recib√≠s <b>${lastPrizeText}</b> con tu pr√≥xima carga.`;

    // armar link de WhatsApp con premio
    const msg = encodeURIComponent(`¬°Hola! Quiero reclamar mi premio ${lastPrizeText}.`);
    claimBtn.href = `https://wa.me/${waNumber}?text=${msg}`;
  }
}

document.getElementById('spinBtn').addEventListener('click', spin);

// valor inicial del bot√≥n Reclamar (por si tocan antes de girar)
claimBtn.href = `https://wa.me/${waNumber}?text=${encodeURIComponent('¬°Hola! Quiero reclamar mi premio.')}`;

// init
resizeCanvas();
draw();
</script>
</body>
</html>
